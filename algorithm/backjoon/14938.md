# 서강그라운드

```python
import sys

input = sys.stdin.readline

def solution():
    n, m, r = map(int, input().split())
    T = [0]+list(map(int, input().split()))
    D = [[150000]*(n+1) for _ in range(n+1)]
    for _ in range(r):
        a, b, l = map(int, input().split())
        D[a][b] = l
        D[b][a] = l
    for k in range(1, n+1):
        D[k][k] = 0
        for i in range(1, n):
            for j in range(i+1, n+1):
                if D[i][k]+D[k][j] < D[i][j]:
                    D[i][j] = D[j][i] = D[i][k]+D[k][j]
    items = [0]*(n+1)
    for i in range(1, n+1):
        items[i] += T[i]
        for j in range(i+1, n+1):
            if D[i][j] <= m:
                items[i] += T[j]
                items[j] += T[i]
    print(max(items))

solution()
```

