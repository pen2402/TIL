# 사탕 게임

```python
def find_candy(candy):
    for i in range(N+1):
        cnt = [[0, False], [0, False], [0, False], [0, False]]
        for j in range(N+1):
            for k in range(4):
                if candy[i][j] == colors[k]:
                    cnt[k][0] += 1
                else:
                    isswap = stop = False
                    if not cnt[k][1]:
                        for dy, dx in delta:
                            if N > i+dy >= 0 and N > j+dx >= 0 and candy[i+dy][j+dx]:
                                if candy[i+dy][j+dx] == colors[k]:
                                    cnt[k][0] += 1
                                    isswap = True
                                    if dy == 0:
                                        stop = True
                                    break
                    if cnt[k][0] > color_cnt[colors[k]]:
                        color_cnt[colors[k]] = cnt[k][0]
                    if stop or not isswap:
                        cnt[k][0] = 0
                        cnt[k][1] = False
                    else:
                        cnt[k][1] = True


N = int(input())
colors = ['C', 'P', 'Z', 'Y']
color_cnt = {'C': 0, 'P': 0, 'Z': 0, 'Y': 0}
candy_original = [list(input()) for _ in range(N)]
candy = [candy_original[i] + [''] for i in range(N)]
candy.append([''] * (N+1))
delta = [(-1, 0), (1, 0), (0, 1)]

find_candy(candy)
find_candy(list(map(list, zip(*candy))))

candy = [candy_original[i][::-1] + [''] for i in range(N)]
candy.append([''] * (N+1))
find_candy(candy)
find_candy(list(map(list, zip(*candy))))

print(max(color_cnt.values()))
```

