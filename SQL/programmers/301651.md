# 멸종위기의 대장균 찾기

```mysql
WITH RECURSIVE GENERATIONS AS (
    SELECT
        ID,
        PARENT_ID,
        1 AS GENERATION
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL
    
    UNION ALL
    
    SELECT
        A.ID,
        A.PARENT_ID,
        B.GENERATION+1 AS GENERATION
    FROM
        ECOLI_DATA A
        JOIN GENERATIONS B ON A.PARENT_ID = B.ID
)

SELECT
    COUNT(*) AS COUNT,
    GENERATION
FROM GENERATIONS A
WHERE
    NOT EXISTS (
        SELECT 1
        FROM ECOLI_DATA B
        WHERE A.ID = B.PARENT_ID
    )
GROUP BY GENERATION;
```

